<!-- ==========================================================
     FOOTER Ã‰LAN POUR TOUS â€” version accessible + TTS intÃ©grÃ©
     ========================================================== -->
<footer class="site-footer" role="contentinfo" aria-label="Pied de page">
  <div class="footer-inner container">
    <a class="footer-brand" href="index.html">
      <img src="assets/ima/baa.png" alt="Ã‰lan pour tous" width="40" height="40" />
      <span class="brand-name">Ã‰lan pour tous</span>
    </a>

    <nav class="footer-nav" aria-label="Liens de pied de page">
      <ul class="footer-links">
        <li><a href="index.html">Accueil</a></li>
        <li><a href="about.html">Ã€ propos</a></li>
        <li><a href="contact.html" aria-current="page">Contact</a></li>
        <li><a href="mentions-legales.html">Mentions lÃ©gales</a></li>
      </ul>
    </nav>

    <p class="footer-copy">Â© 2025 Ã‰lan pour tous â€” Tous droits rÃ©servÃ©s</p>
  </div>

  <!-- ðŸŽ§ Barre TTS (lecture Ã  voix haute) -->
  <div class="tts-bar" role="region" aria-label="Lecture Ã  voix haute">
    <div class="tts-row">
      <button class="btn tts-btn" id="tts-play" title="Lire (Alt+L)" aria-label="Lire la page">
        <svg aria-hidden="true" viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M8 5v14l11-7z"/></svg>
        <span class="btn-label">Lire</span>
      </button>
      <button class="btn tts-btn" id="tts-pause" title="Pause (Alt+P)" aria-label="Pause" disabled>
        <svg aria-hidden="true" viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M6 5h4v14H6zm8 0h4v14h-4z"/></svg>
        <span class="btn-label">Pause</span>
      </button>
      <button class="btn tts-btn" id="tts-resume" title="Reprendre (Alt+R)" aria-label="Reprendre" disabled>
        <svg aria-hidden="true" viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M8 5v14l11-7zM5 5h2v14H5z"/></svg>
        <span class="btn-label">Reprendre</span>
      </button>
      <button class="btn tts-btn" id="tts-stop" title="Stop (Alt+S)" aria-label="Stop" disabled>
        <svg aria-hidden="true" viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M6 6h12v12H6z"/></svg>
        <span class="btn-label">Stop</span>
      </button>
    </div>

    <div class="tts-row">
      <label for="tts-rate">Vitesse :</label>
      <input id="tts-rate" type="range" min="0.7" max="1.6" step="0.1" value="1.0" />
      <span id="tts-rate-val" aria-live="polite">1.0Ã—</span>
    </div>

    <div class="tts-row">
      <label for="tts-voice">Voix :</label>
      <select id="tts-voice" aria-label="Choisir la voix de synthÃ¨se"></select>
    </div>

    <p id="tts-live" class="sr-only" role="status" aria-live="polite"></p>
  </div>
</footer>

<!-- ==========================================================
     Script de lecture vocale (propre, sans double init)
     ========================================================== -->
<script>
(function () {
  if (window._ttsInit) return;
  window._ttsInit = true;

  const synth = window.speechSynthesis;
  if (!('speechSynthesis' in window)) return;

  const play = document.getElementById('tts-play'),
        pause = document.getElementById('tts-pause'),
        resume = document.getElementById('tts-resume'),
        stop = document.getElementById('tts-stop'),
        rate = document.getElementById('tts-rate'),
        rateVal = document.getElementById('tts-rate-val'),
        voiceSel = document.getElementById('tts-voice'),
        live = document.getElementById('tts-live');

  let utterance = null;

  // -------- Charger les voix --------
  function populateVoices() {
    const voices = synth.getVoices();
    voiceSel.innerHTML = '';
    voices.filter(v => v.lang.startsWith('fr'))
      .concat(voices)
      .forEach(v => {
        const opt = document.createElement('option');
        opt.value = v.name;
        opt.textContent = `${v.name} (${v.lang})`;
        voiceSel.appendChild(opt);
      });
  }
  populateVoices();
  if (typeof speechSynthesis.onvoiceschanged !== 'undefined') {
    speechSynthesis.onvoiceschanged = populateVoices;
  }

  // -------- Lecture --------
  function getText() {
    const main = document.getElementById('contenu') || document.body;
    return main.innerText.replace(/\s+/g, ' ').trim();
  }

  function speak(text) {
    if (!text) return;
    synth.cancel();
    utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = 'fr-FR';
    utterance.rate = parseFloat(rate.value);
    const selected = Array.from(synth.getVoices()).find(v => v.name === voiceSel.value);
    if (selected) utterance.voice = selected;
    utterance.onstart = () => { live.textContent = 'Lecture en cours'; toggleState(true); };
    utterance.onend = () => { live.textContent = 'Lecture terminÃ©e'; toggleState(false); };
    utterance.onerror = () => { live.textContent = 'Erreur de lecture'; toggleState(false); };
    synth.speak(utterance);
  }

  function toggleState(active) {
    play.disabled = active;
    pause.disabled = !active;
    resume.disabled = !active;
    stop.disabled = !active;
  }

  // -------- ContrÃ´les --------
  play.addEventListener('click', () => speak(getText()));
  pause.addEventListener('click', () => { synth.pause(); live.textContent = 'Lecture en pause'; });
  resume.addEventListener('click', () => { synth.resume(); live.textContent = 'Reprise'; });
  stop.addEventListener('click', () => { synth.cancel(); toggleState(false); live.textContent = 'Lecture stoppÃ©e'; });
  rate.addEventListener('input', () => { rateVal.textContent = rate.value + 'Ã—'; });

  // -------- Raccourcis clavier --------
  document.addEventListener('keydown', e => {
    if (!e.altKey) return;
    const k = e.key.toLowerCase();
    if (k === 'l') { e.preventDefault(); speak(getText()); }
    if (k === 'p') { e.preventDefault(); synth.pause(); }
    if (k === 'r') { e.preventDefault(); synth.resume(); }
    if (k === 's') { e.preventDefault(); synth.cancel(); toggleState(false); }
  });
})();
</script>

<style>
  /* ==================== Footer compact ==================== */
  .site-footer {
    background: var(--card, #f8f8f8);
    border-top: 1px solid var(--border, #ddd);
    padding: 1rem;
  }
  .footer-inner {
    display: grid;
    gap: .75rem;
    align-items: center;
    justify-items: center;
    text-align: center;
  }
  .footer-brand {
    display: inline-flex;
    align-items: center;
    gap: .5rem;
    text-decoration: none;
    color: inherit;
  }
  .brand-name { font-weight: 700; }
  .footer-links {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
  }
  .footer-links a {
    text-decoration: none;
  }
  .footer-links a:hover,
  .footer-links a:focus-visible {
    text-decoration: underline;
  }
  .footer-copy {
    margin: 0;
    font-size: .9rem;
    color: #555;
  }
</style>
