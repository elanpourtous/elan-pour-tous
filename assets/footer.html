<!-- FOOTER (minimal + TTS intÃ©grÃ©) -->
<footer class="site-footer" role="contentinfo" aria-label="Pied de page">
  <div class="footer-inner container">
    <a class="footer-brand" href="index.html">
      <img src="assets/ima/baa.png" alt="Ã‰lan pour tous" width="40" height="40" />
      <span class="brand-name">Ã‰lan pour tous</span>
    </a>

    <nav class="footer-nav" aria-label="Liens de pied de page">
      <ul class="footer-links">
        <li><a href="index.html">Accueil</a></li>
        <li><a href="about.html">Ã€ propos</a></li>
        <li><a href="contact.html" aria-current="page">Contact</a></li>
        <li><a href="mentions-legales.html">Mentions lÃ©gales</a></li>
      </ul>
    </nav>

    <p class="footer-copy">Â© 2025 Ã‰lan pour tous â€” Tous droits rÃ©servÃ©s</p>
  </div>

  <!-- ðŸŽ§ Barre TTS (lecture Ã  voix haute) -->
  <div class="tts-bar" role="region" aria-label="Lecture Ã  voix haute">
    <div class="tts-row">
      <!-- LIRE -->
      <button class="btn tts-btn" id="tts-play" title="Lire (Alt+L)" aria-label="Lire">
        <svg aria-hidden="true" viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M8 5v14l11-7z"/></svg>
        <span class="btn-label">Lire</span>
      </button>

      <!-- PAUSE -->
      <button class="btn tts-btn" id="tts-pause" title="Pause (Alt+P)" aria-label="Pause" disabled>
        <svg aria-hidden="true" viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M6 5h4v14H6zm8 0h4v14h-4z"/></svg>
        <span class="btn-label">Pause</span>
      </button>

      <!-- REPRENDRE -->
      <button class="btn tts-btn" id="tts-resume" title="Reprendre (Alt+R)" aria-label="Reprendre" disabled>
        <svg aria-hidden="true" viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M8 5v14l11-7zM5 5h2v14H5z"/></svg>
        <span class="btn-label">Reprendre</span>
      </button>

      <!-- STOP -->
      <button class="btn tts-btn" id="tts-stop" title="Stop (Alt+S)" aria-label="Stop" disabled>
        <svg aria-hidden="true" viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M6 6h12v12H6z"/></svg>
        <span class="btn-label">Stop</span>
      </button>
    </div>

    <div class="tts-row">
      <label for="tts-rate">Vitesse :</label>
      <input id="tts-rate" type="range" min="0.7" max="1.6" step="0.1" value="1.0" />
      <span id="tts-rate-val" aria-live="polite">1.0Ã—</span>
    </div>

    <div class="tts-row">
      <label for="tts-voice">Voix :</label>
      <select id="tts-voice" aria-label="Choisir la voix de synthÃ¨se"></select>
    </div>

    <!-- RÃ©gion live (annonces lecteurs dâ€™Ã©cran) -->
    <p id="tts-live" class="sr-only" role="status" aria-live="polite"></p>
  </div>
</footer>

<!-- JS TTS minimal (protÃ©gÃ© contre double init) -->
<script>
  (function () {
    if (window._ttsInit) return; // Ã©viter double initialisation si footer inclus partout
    window._ttsInit = true;

    const hasTTS = 'speechSynthesis' in window && 'SpeechSynthesisUtterance' in window;
    const playBtn = document.getElementById('tts-play');
    const pauseBtn = document.getElementById('tts-pause');
    const resumeBtn = document.getElementById('tts-resume');
    const stopBtn = document.getElementById('tts-stop');
    const rate = document.getElementById('tts-rate');
    const rateVal = document.getElementById('tts-rate-val');
    const voiceSel = document.getElementById('tts-voice');
    const live = document.getElementById('tts-live');

    function setState(playing) {
      pauseBtn.disabled = !playing;
      resumeBtn.disabled = !playing;
      stopBtn.disabled = !playing;
      playBtn.disabled = playing;
    }

    function getText() {
      // Lis le contenu principal (#contenu) s'il existe, sinon tout le body
      const main = document.getElementById('contenu') || document.body;
      const clone = main.cloneNode(true);
      clone.querySelectorAll('.tts-bar, script, style').forEach(n => n.remove());
      return clone.innerText.replace(/\s+/g, ' ').trim();
    }

    let currentUtterance = null;

    function populateVoices() {
      const voices = speechSynthesis.getVoices();
      voiceSel.innerHTML = '';
      voices
        .filter(v => v.lang.toLowerCase().startsWith('fr'))
        .concat(voices) // fallback autres langues Ã  la fin
        .filter((v, i, arr) => arr.indexOf(v) === i)
        .forEach(v => {
          const opt = document.createElement('option');
          opt.value = v.name;
          opt.textContent = `${v.name} (${v.lang})`;
          voiceSel.appendChild(opt);
        });
    }

    function speak(text) {
      window.speechSynthesis.cancel();
      const u = new SpeechSynthesisUtterance(text || 'Aucun contenu Ã  lire.');
      u.lang = 'fr-FR';
      u.rate = parseFloat(rate.value || '1');
      const chosen = Array.from(speechSynthesis.getVoices()).find(v => v.name === voiceSel.value);
      if (chosen) u.voice = chosen;
      u.onend = () => { setState(false); live.textContent = 'Lecture terminÃ©e.'; };
      u.onerror = () => { setState(false); live.textContent = 'Erreur de lecture.'; };
      currentUtterance = u;
      window.speechSynthesis.speak(u);
      live.textContent = 'Lecture en coursâ€¦';
      setState(true);
    }

    if (!hasTTS) {
      document.querySelector('.tts-bar').insertAdjacentHTML('beforeend',
        '<span class="hint">La lecture vocale nâ€™est pas disponible sur ce navigateur.</span>');
      [playBtn, pauseBtn, resumeBtn, stopBtn, rate, voiceSel].forEach(el => el && (el.disabled = true));
      return;
    }

    populateVoices();
    if (speechSynthesis.onvoiceschanged !== undefined) {
      speechSynthesis.onvoiceschanged = populateVoices;
    }

    playBtn.addEventListener('click', () => speak(getText()));
    pauseBtn.addEventListener('click', () => { speechSynthesis.pause(); live.textContent = 'Pause.'; });
    resumeBtn.addEventListener('click', () => { speechSynthesis.resume(); live.textContent = 'Reprise.'; });
    stopBtn.addEventListener('click', () => { speechSynthesis.cancel(); setState(false); live.textContent = 'Lecture stoppÃ©e.'; });

    rate.addEventListener('input', () => { rateVal.textContent = `${parseFloat(rate.value).toFixed(1)}Ã—`; });

    // Raccourcis clavier
    document.addEventListener('keydown', (e) => {
      if (!e.altKey) return;
      const k = e.key.toLowerCase();
      if (k === 'l') { e.preventDefault(); speak(getText()); }
      if (k === 'p') { e.preventDefault(); speechSynthesis.pause(); }
      if (k === 'r') { e.preventDefault(); speechSynthesis.resume(); }
      if (k === 's') { e.preventDefault(); speechSynthesis.cancel(); setState(false); }
    });
  })();
</script>

<style>
  /* Mini styles footer â€“ sâ€™appuie sur tes variables globales */
  .site-footer { background: var(--card, #f8f8f8); border-top: 1px solid var(--border,#ddd); padding: 1rem; }
  .footer-inner { display: grid; gap: .75rem; align-items: center; justify-items: center; }
  .footer-brand { display: inline-flex; align-items: center; gap: .5rem; text-decoration: none; color: inherit; }
  .brand-name { font-weight: 700; }
  .footer-links { list-style: none; padding: 0; margin: 0; display: flex; gap: 1rem; flex-wrap: wrap; }
  .footer-links a { text-decoration: none; }
  .footer-links a:hover, .footer-links a:focus-visible { text-decoration: underline; }
  .footer-copy { margin: 0; font-size: .95rem; color: #444; }
</style>
