/* ==========================================================
   Élan pour tous — rgaa-accessible.css
   Version : 2025-10-31
   Objet : Styles d’accessibilité transverses (RGAA, WCAG)
   Portée : Utilitaires non-intrusifs qui complètent style.css
           (pas de reset lourd, pas d’override visuel agressif)
   ========================================================== */

/* 0) Variables minimales (fallback si non définies ailleurs) */
:root{
  --fg: #0b0f12;                 /* texte par défaut */
  --bg: #ffffff;                 /* fond */
  --brand: #0b8457;              /* teinte de marque */
  --link: #0b62cf;               /* liens */
  --border: #d8dee6;             /* bordures */
  --card: #f7f9fb;               /* surfaces */
  --focus: #94c5ff;              /* halo de focus */
}
@media (prefers-color-scheme: dark){
  :root{--fg:#e7edf4;--bg:#0b0f12;--link:#86b7ff;--border:#2b3440;--card:#131922;--focus:#2f86ff}
}

/* 1) Visibilité du focus clavier ------------------------ */
:where(a, button, input, select, textarea, [role="button"], [tabindex]):focus-visible{
  outline:3px solid var(--focus);
  outline-offset:2px;
  border-radius:.25rem;
}
/* Pas d’annulation de focus au clic : ne rien mettre ici */

/* 2) Liens et zones cliquables -------------------------- */
a{color:var(--link);text-decoration-thickness:2px;text-underline-offset:2px}
a:visited{opacity:.95}
a:hover{filter:brightness(1.08)}

/* Taille de cible minimale (WCAG 2.5.8 Target Size AAA) */
:where(a,button,[role="button"]) {min-height:44px;min-width:44px;}

/* 3) Skip link (ajoutez <a class="skip-link" href="#main">... */
.skip-link{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
.skip-link:focus{left:1rem;top:1rem;width:auto;height:auto;background:var(--bg);color:var(--fg);border:2px solid var(--focus);padding:.5rem .75rem;border-radius:.5rem;z-index:1000}

/* 4) Utilitaires lecteurs d’écran ----------------------- */
.visually-hidden{position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
.only-screenreaders{position:absolute!important;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden}

/* 5) États ARIA & annonces polies ---------------------- */
[role="status"],[aria-live="polite"]{contain:content}
[role="alert"],[aria-live="assertive"]{contain:content}

/* Contrastes d’arrière-plan pour messages */
.aria-success{background:color-mix(in srgb, var(--brand) 12%, transparent);border:1px solid color-mix(in srgb, var(--brand) 35%, var(--border));padding:.75rem 1rem;border-radius:.5rem}
.aria-error{background:color-mix(in srgb, #c62828 12%, transparent);border:1px solid color-mix(in srgb, #c62828 35%, var(--border));padding:.75rem 1rem;border-radius:.5rem}

/* 6) Formulaires : lisibilité & erreurs ---------------- */
label{font-weight:600}
:where(input, textarea, select){
  background:var(--bg);color:var(--fg);
  border:1.5px solid var(--border);border-radius:.6rem;
  padding:.7rem .8rem;line-height:1.4;
}
:where(input, textarea)::placeholder{opacity:.8}
:where(input, textarea, select):focus-visible{outline:3px solid var(--focus);outline-offset:2px}

/* Champs requis/invalides (support natif + aria-invalid) */
:where(input, textarea, select):user-invalid,
:where(input, textarea, select)[aria-invalid="true"]{
  border-color:#c62828;box-shadow:0 0 0 2px color-mix(in srgb, #c62828 22%, transparent);
}

/* Groupes de champs (fieldset/legend) */
fieldset{border:1px solid var(--border);border-radius:.6rem;padding:1rem}
legend{padding:0 .4rem;font-weight:700}

/* 7) Tableaux accessibles ------------------------------- */
.table-access{width:100%;border-collapse:separate;border-spacing:0}
.table-access th,.table-access td{border:1px solid var(--border);padding:.6rem .7rem}
.table-access thead th{background:var(--card);text-align:left}
.table-access tbody tr:nth-child(even){background:color-mix(in srgb, var(--card) 65%, transparent)}

/* 8) Composants spécifiques (existant utilisateur) ------ */
/* Conserve et améliore le composant fourni par l’utilisateur */
.reader-speed-label {
  display:inline-flex; align-items:center; gap:.4rem;
  font-size:.95rem; font-weight:600; color:var(--fg);
}
.reader-speed-label select {
  background:var(--card); color:var(--fg);
  border:1px solid var(--border); border-radius:.4rem;
  padding:.35rem .5rem;
}
.reader-speed-label select:focus {
  outline:3px solid var(--focus); outline-offset:2px;
}

/* 9) Boutons et liens type bouton ----------------------- */
.button-access{appearance:none;border:2px solid transparent;border-radius:.7rem;padding:.7rem 1rem;font-weight:700;cursor:pointer}
.button-access.primary{background:var(--brand);color:#fff}
.button-access.secondary{background:transparent;color:var(--brand);border-color:var(--brand)}
.button-access:focus-visible{outline:3px solid var(--focus);outline-offset:2px}

/* 10) Réduction des animations & clignotements ---------- */
@media (prefers-reduced-motion: reduce){
  *{animation-duration:0.001ms !important;animation-iteration-count:1 !important;transition-duration:0.001ms !important;scroll-behavior:auto !important}
}

/* 11) Contraste renforcé (si l’utilisateur le demande) -- */
@media (prefers-contrast: more){
  :root{--border: color-mix(in srgb, var(--fg) 25%, var(--border));}
  :where(a, button, input, select, textarea){border-color:var(--border)}
  a{text-decoration-thickness:3px}
}

/* 12) Mode High Contrast Windows (forced-colors) -------- */
@media (forced-colors: active){
  :where(a,button,input,select,textarea,[role="button"]):focus-visible{outline:2px solid CanvasText}
  .button-access.primary{forced-color-adjust:auto}
}

/* 13) Helpers d’impression ------------------------------ */
@media print{
  .skip-link{display:none}
  a[href]::after{content:" (" attr(href) ")";font-size:.9em}
}

/* 14) Petits utilitaires ------------------------------- */
.sr-announcer{position:absolute;left:-9999px;width:1px;height:1px;overflow:hidden}
.badge-req{color:#c62828;font-weight:700}

/* 15) Zones de navigation --------------------------------*/
[role="navigation"] a[aria-current="page"], .nav-links a.active{
  outline:2px dashed color-mix(in srgb, var(--brand) 50%, transparent);
  outline-offset:2px;
}
