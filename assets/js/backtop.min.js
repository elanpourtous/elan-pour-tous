<!-- assets/js/backtop.min.js -->
<script>
(function(){
  const btn = document.getElementById('back-top-btn');
  if(!btn) return;

  let shown = false;
  function toggle(show){
    if(show === shown) return;
    shown = show;
    if(show){
      btn.classList.add('show');
      btn.removeAttribute('aria-hidden');
    }else{
      btn.classList.remove('show');
      btn.setAttribute('aria-hidden','true');
    }
  }

  function onScroll(){
    const y = window.pageYOffset || document.documentElement.scrollTop || 0;
    toggle(y > 300);
  }

  function smoothTop(){
    try{ window.scrollTo({ top: 0, behavior: 'smooth' }); }
    catch{ window.scrollTo(0,0); }
    btn.blur();
  }

  btn.addEventListener('click', smoothTop);

  // Raccourci clavier : Alt + FlècheHaut
  document.addEventListener('keydown', (e)=>{
    if(e.altKey && (e.key === 'ArrowUp' || e.code === 'ArrowUp')){
      e.preventDefault();
      smoothTop();
    }
  });

  window.addEventListener('scroll', onScroll, { passive: true });
  onScroll(); // état initial
})();
</script>
