(function(){if(window.__EPT_INIT__)return;window.__EPT_INIT__=true;const d=document,r=d.documentElement,b=d.body,$=(s,c=d)=>c.querySelector(s),$$=(s,c=d)=>Array.from(c.querySelectorAll(s));(function(){const m=$('#menu-toggle'),n=$('#primary-nav');if(!m||!n)return;m.setAttribute('aria-expanded','false');m.setAttribute('aria-controls','primary-nav');if(!n.hasAttribute('hidden'))n.setAttribute('hidden','');m.addEventListener('click',()=>{const e=m.getAttribute('aria-expanded')==='true';m.setAttribute('aria-expanded',String(!e));m.setAttribute('aria-label',e?'Ouvrir le menu':'Fermer le menu');n.toggleAttribute('hidden');if(!e)n.querySelector('a')?.focus();});d.addEventListener('keydown',e=>{if(e.key==='Escape'&&m.getAttribute('aria-expanded')==='true'){m.click();m.focus();}});})();(function(){try{const p=location.pathname.split('/').pop()||'index.html';$$('#primary-nav a').forEach(a=>{const h=a.getAttribute('href')||'';h.endsWith(p)?a.setAttribute('aria-current','page'):a.removeAttribute('aria-current');});}catch(_){}})();(function(){if(!getComputedStyle(r).getPropertyValue('--font-scale'))r.style.setProperty('--font-scale','1');const s=JSON.parse(localStorage.getItem('accessPrefs')||'{}');if(s.fontScale)r.style.setProperty('--font-scale',s.fontScale);if(s.contrast)b.classList.add('high-contrast');if(s.spacing)b.classList.add('wide-spacing');function save(){localStorage.setItem('accessPrefs',JSON.stringify({fontScale:r.style.getPropertyValue('--font-scale'),contrast:b.classList.contains('high-contrast'),spacing:b.classList.contains('wide-spacing')}));}const A={'font+':()=>{let v=parseFloat(getComputedStyle(r).getPropertyValue('--font-scale'))||1;if(v<1.6){v=+(v+0.1).toFixed(2);r.style.setProperty('--font-scale',String(v));save();}},'font-':()=>{let v=parseFloat(getComputedStyle(r).getPropertyValue('--font-scale'))||1;if(v>0.8){v=+(v-0.1).toFixed(2);r.style.setProperty('--font-scale',String(v));save();}},contrast:()=>{b.classList.toggle('high-contrast');save();},spacing:()=>{b.classList.toggle('wide-spacing');save();},reset:()=>{r.style.setProperty('--font-scale','1');b.classList.remove('high-contrast','wide-spacing');localStorage.removeItem('accessPrefs');}};$$('.access-btn[data-action]').forEach(x=>{const a=x.getAttribute('data-action');x.addEventListener('click',e=>{e.preventDefault();A[a]?.();});});d.addEventListener('keydown',e=>{if(!e.altKey)return;const k=e.key.toLowerCase();if(k==='-'){e.preventDefault();A['font-']();}if(k==='='){e.preventDefault();A['font+']();}if(k==='c'){e.preventDefault();A['contrast']();}if(k==='s'){e.preventDefault();A['spacing']();}if(k==='0'){e.preventDefault();A['reset']();}});})();(function(){const t=$('#theme-toggle'),m=$('meta[name="theme-color"]');const pref=window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches;const sv=localStorage.getItem('theme');const init=sv||(pref?'dark':'light');apply(init,false);t&&t.addEventListener('click',()=>{const nx=r.getAttribute('data-theme')==='dark'?'light':'dark';apply(nx,true);});if(!sv&&window.matchMedia){window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change',e=>apply(e.matches?'dark':'light',false));}function apply(mode,p){r.setAttribute('data-theme',mode);const d=mode==='dark';if(t){t.setAttribute('aria-pressed',String(d));t.setAttribute('aria-label',d?'Désactiver le mode sombre':'Activer le mode sombre');t.setAttribute('title',d?'Désactiver le mode sombre':'Activer le mode sombre');}if(m)m.setAttribute('content',d?'#0a6a47':'#0b8457');if(p)localStorage.setItem('theme',mode);}})();(function(){const g=$('#tts-toggle'),bar=d.querySelector('.tts-bar');if(!g||!bar)return;bar.removeAttribute('hidden');const sv=localStorage.getItem('ttsVisible');const show=sv?(sv==='shown'):true;if(show){bar.classList.add('is-visible');bar.removeAttribute('aria-hidden');g.setAttribute('aria-pressed','true');}else{bar.classList.remove('is-visible');bar.setAttribute('aria-hidden','true');g.setAttribute('aria-pressed','false');}function on(){bar.classList.add('is-visible');bar.removeAttribute('aria-hidden');g.setAttribute('aria-pressed','true');localStorage.setItem('ttsVisible','shown');}function off(){bar.classList.remove('is-visible');bar.setAttribute('aria-hidden','true');g.setAttribute('aria-pressed','false');localStorage.setItem('ttsVisible','hidden');}g.addEventListener('click',()=>{bar.classList.contains('is-visible')?off():on();});})();})();
